pipeline {

  environment {
    CI = false
  }

  agent {
    kubernetes {
      defaultContainer 'jnlp'
      inheritFrom 'jenkins-slave'
      yaml """
      apiVersion: v1
      kind: Pod
      metadata:
        labels:
          component: ci
      spec:
        containers:
        - name: node
          image: node:lts-alpine
          imagePullPolicy: IfNotPresent
          command:
          - cat
          tty: true
"""
    }
  }

  stages {
    stage('Build') {
      steps {
        container('node') {
          sh """
            echo "*** building ***"
            CI=${CI}
            npm install
            npm run build
          """
        }
      }
    }
  }
}
